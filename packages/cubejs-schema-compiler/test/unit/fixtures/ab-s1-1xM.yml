cubes:
###
  - name: a
    sql_table: a
    joins:
      - name: b
        sql: "{a}.id = {b}.a_id"
        relationship: one_to_many
    dimensions:
      - name: id
        sql: id
        type: number
        primary_key: true
      - name: shared_id
        sql: shared_id
        type: number
    measures:
      - name: count
        type: count
###        
  - name: b
    sql_table: b
    joins:      
    dimensions:
      - name: id
        sql: id
        type: number
        primary_key: true
      - name: a_id
        sql: a_id
        type: number
      - name: shared_id
        sql: shared_id
        type: number
    measures:
      - name: count
        type: count
###
  - name: s1
    sql_table: s1
    joins:
      - name: a
        sql: "{s1}.id = {b.shared_id}"
        relationship: one_to_many
    dimensions:
      - name: id
        sql: id
        type: number
        primary_key: true
    measures:
      - name: count
        type: count

views:
  - name: sp
    cubes:
      - join_path: a
        includes: "*"
        prefix: true
      - join_path: b
        includes: "*"
        prefix: true

      - join_path: s1
        includes: "*"
        split: true