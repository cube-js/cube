# SQL API reference

SQL API supports the following [functions and operators](#sql-functions-and-operators).

## SQL functions and operators

SQL API currently implements a subset of functions and operators [supported by
PostgreSQL][link-postgres-funcs].

<InfoBox>

If you'd like to propose a function or an operator to be implemented by the SQL API,
check the existing [issues on GitHub][link-github-sql-api]. If there's no relevant
issue, please [file a new one][link-github-new-sql-api-issue].

</InfoBox>

{/*

What about the following?

- https://www.postgresql.org/docs/16/functions-comparison.html#FUNCTIONS-COMPARISON-OP-TABLE
- https://www.postgresql.org/docs/16/functions-math.html#FUNCTIONS-MATH-OP-TABLE
- https://www.postgresql.org/docs/16/functions-string.html (`format` and `||`)
- https://www.postgresql.org/docs/current/functions-datetime.html#OPERATORS-DATETIME-TABLE
- DATEDIFF and DATE
- \d and similar

*/}

### Comparison predicates

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/16/functions-comparison.html#FUNCTIONS-COMPARISON-PRED-TABLE)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `IS NULL` | Test whether value is `NULL` |  |
| `IS NOT NULL` | Test whether value is not `NULL` |  |

### Mathematical functions

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/16/functions-math.html#FUNCTIONS-MATH-FUNC-TABLE)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `ABS` | Absolute value |  |
| `CEIL` | Nearest integer greater than or equal to argument |  |
| `DEGREES` | Converts radians to degrees |  |
| `EXP` | Exponential (`e` raised to the given power) |  |
| `FLOOR` | Nearest integer less than or equal to argument |  |
| `LN` | Natural logarithm |  |
| `LOG` | Base 10 logarithm |  |
| `LOG10` | Base 10 logarithm (same as `LOG`) |  |
| `PI` | Approximate value of `π` |  |
| `POWER` | `a` raised to the power of `b` |  |
| `RADIANS` | Converts degrees to radians |  |
| `ROUND` | Rounds `v` to `s` decimal places |  |
| `SIGN` | Sign of the argument (`-1`, `0`, or `+1`) |  |
| `SQRT` | Square root |  |
| `TRUNC` | Truncates to integer (towards zero) |  |

### Trigonometric functions

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/16/functions-math.html#FUNCTIONS-MATH-TRIG-TABLE)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `ACOS` | Inverse cosine, result in radians |  |
| `ASIN` | Inverse sine, result in radians |  |
| `ATAN` | Inverse tangent, result in radians |  |
| `ATAN2` | Inverse tangent of `y/x`, result in radians |  |
| `COS` | Cosine, argument in radians |  |
| `COT` | Cotangent, argument in radians |  |
| `SIN` | Sine, argument in radians |  |
| `TAN` | Tangent, argument in radians |  |

### String functions

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/16/functions-string.html#FUNCTIONS-STRING-SQL)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `BTRIM` | Removes the longest string containing only characters in `characters` from the start and end of `string` |  |
| `CHAR_LENGTH` | Returns number of characters in the string |  |
| `LOWER` | Converts the string to all lower case |  |
| `LTRIM` | Removes the longest string containing only characters in `characters` from the start of `string` |  |
| `POSITION` | Returns first starting index of the specified `substring` within `string`, or zero if it's not present |  |
| `RTRIM` | Removes the longest string containing only characters in `characters` from the end of `string` |  |
| `SUBSTRING` | Extracts the substring of `string` |  |
| `UPPER` | Converts the string to all upper case |  |

### Other string functions

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/16/functions-string.html#FUNCTIONS-STRING-OTHER)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `ASCII` | Returns the numeric code of the first character of the argument |  |
| `CONCAT` | Concatenates the text representations of all the arguments |  |
| `LEFT` | Returns first `n` characters in the string, or when `n` is negative, returns all but last `ABS(n)` characters |  |
| `REPEAT` | Repeats string the specified number of times |  |
| `REPLACE` | Replaces all occurrences in `string` of substring `from` with substring `to` |  |
| `RIGHT` | Returns last `n` characters in the string, or when `n` is negative, returns all but first `ABS(n)` characters |  |

### Data type formatting functions

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/current/functions-formatting.html)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `TO_CHAR` | Converts a timestamp to string according to the given format |  |

### Date/time functions

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/current/functions-datetime.html#FUNCTIONS-DATETIME-TABLE)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `DATE_ADD` | Add an interval to a timestamp with time zone |  |
| `DATEDIFF` | From [Redshift](https://docs.aws.amazon.com/redshift/latest/dg/r_DATEDIFF_function.html). Returns the difference between the date parts of two date or time expressions |  |
| `DATE` | From [MySQL](https://dev.mysql.com/doc/refman/8.4/en/date-and-time-functions.html#function_date). Extracts the date part of the date or datetime expression |  |

### Conditional expressions

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/16/functions-conditional.html)
of the PostgreSQL documentation.

</InfoBox>

| Function, expression | Description | Support |
| --- | --- | --- |
| `CASE` | Generic conditional expression |  |
| `COALESCE` | Returns the first of its arguments that is not `NULL` |  |
| `NULLIF` | Returns `NULL` if both arguments are equal, otherwise returns the first argument |  |
| `GREATEST` | Select the largest value from a list of expressions |  |
| `LEAST` | Select the smallest value from a list of expressions |  |

### General-purpose aggregate functions

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/16/functions-aggregate.html#FUNCTIONS-AGGREGATE-TABLE)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `AVG` | Computes the average (arithmetic mean) of all the non-`NULL` input values |  |
| `COUNT` | Computes the number of input rows in which the input value is not `NULL` |  |
| `COUNT(DISTINCT)` | Computes the number of input rows containing unique input values |  |
| `MAX` | Computes the maximum of the non-`NULL` input values |  |
| `MIN` | Computes the minimum of the non-`NULL` input values |  |
| `SUM` | Computes the sum of the non-`NULL` input values |  |

### Aggregate functions for statistics

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/16/functions-aggregate.html#FUNCTIONS-AGGREGATE-STATISTICS-TABLE)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | Support |
| --- | --- | --- |
| `COVAR_POP` | Computes the population covariance |  |
| `COVAR_SAMP` | Computes the sample covariance |  |
| `STDDEV_POP` | Computes the population standard deviation of the input values |  |
| `STDDEV_SAMP` | Computes the sample standard deviation of the input values |  |
| `VAR_POP` | Computes the population variance of the input values |  |
| `VAR_SAMP` | Computes the sample variance of the input values |  |

### Row and array comparisons

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/current/functions-comparisons.html)
of the PostgreSQL documentation.

</InfoBox>

| Function | Description | [Pushdown][ref-qpd] | <nobr>[Post-processing][ref-qpp]</nobr> |
| --- | --- | --- | --- |
| `IN` |  | ❓ | ✅ Selections |
| `NOT IN` | Returns `TRUE` if a left-side value matches **none** of right-side values |  |  |

#### `IN`

Returns `TRUE` if a left-side value matches **any** of right-side values.

|  | Support |
| --- | --- |
| [Pushdown][ref-qpd] | ❓ |
| [Post-processing][ref-qpd] (inner query) | ✅ Selections<br/>❌ Projections |
| [Post-processing][ref-qpd] (outer query) | ✅ Yes |

|  | Support |
| --- | --- |
| [Pushdown][ref-qpd] | ❓ |
| [Post-processing][ref-qpd] (inner query) | ✅ Selections<br/>❌ Projections |
| [Post-processing][ref-qpd] (outer query) | ✅ Yes |

<InfoBox>

You can learn more in the
[relevant section](https://www.postgresql.org/docs/current/functions-comparisons.html#FUNCTIONS-COMPARISONS-IN-SCALAR)
of the PostgreSQL documentation.

</InfoBox>

#### `NOT IN`


[ref-qpd]: #
[ref-qpp]: #

[link-postgres-funcs]: https://www.postgresql.org/docs/16/functions.html
[link-github-sql-api]: https://github.com/cube-js/cube/issues?q=is%3Aopen+is%3Aissue+label%3Aapi%3Asql
[link-github-new-sql-api-issue]: https://github.com/cube-js/cube/issues/new?assignees=&labels=&projects=&template=sql_api_query_issue.md&title=