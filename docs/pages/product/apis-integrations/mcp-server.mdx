# MCP server

The Cube MCP (Model Context Protocol) server provides seamless integration with AI assistants like Claude Desktop and Cursor, enabling direct chat functionality with Cube's AI agent for analytics and data exploration.

<InfoBox>

The MCP server is available on [Premium and Enterprise plans](https://cube.dev/pricing).

</InfoBox>

## What is MCP?

Model Context Protocol (MCP) is an open standard that enables AI assistants to securely connect to external data sources and tools. The Cube MCP Server acts as a bridge between your AI assistant and Cube's analytics platform, allowing you to ask data questions directly from your coding environment.


## Tools Available

- `chat`: Interactive chat with Cube AI agent for analytics and data exploration with streaming real-time responses

## Installation & Setup

### Prerequisites

Before setting up the MCP server, ensure you have:

- **Admin privileges** in your Cube instance
- An active Cube tenant
- Claude Desktop or Cursor installed

### 1. Obtain Required Credentials

You'll need three key pieces of information:

#### `CUBE_CHAT_API_URL`

- Copy the complete Chat API URL from your agent settings (**Chat API URL** field) in <Btn>Admin → Agents → Click on Agent</Btn>
- This is the full endpoint URL for your agent

#### `CUBE_API_KEY`

- Navigate to <Btn>Admin → API Keys</Btn> to obtain your API key

#### User Identity (choose one)

- **`INTERNAL_USER_ID`**: Email address of an existing Cube user. Use this for internal team members who already have Cube accounts. The user's existing permissions and settings will be used.
- **`EXTERNAL_USER_ID`**: A unique identifier for external/third-party users (e.g., "user-123", "customer@external.com"). Use this when you need to provide custom user attributes, groups, or row-level security settings.

## Configuration

Add the following configuration to your Claude Desktop or Cursor MCP settings:

### For Internal Cube Users

```json
{
  "mcpServers": {
    "cube-mcp-server": {
      "command": "npx",
      "args": ["@cube-dev/mcp-server"],
      "env": {
        "CUBE_CHAT_API_URL": "https://ai.{cloudRegion}.cubecloud.dev/api/v1/public/{accountName}/agents/{agentId}/chat/stream-chat-state",
        "CUBE_API_KEY": "your_api_key_here",
        "INTERNAL_USER_ID": "analyst@yourcompany.com"
      }
    }
  }
}
```

### For External Users

```json
{
  "mcpServers": {
    "cube-mcp-server": {
      "command": "npx",
      "args": ["@cube-dev/mcp-server"],
      "env": {
        "CUBE_CHAT_API_URL": "https://ai.{cloudRegion}.cubecloud.dev/api/v1/public/{accountName}/agents/{agentId}/chat/stream-chat-state",
        "CUBE_API_KEY": "your_api_key_here",
        "EXTERNAL_USER_ID": "user-123"
      }
    }
  }
}
```

## Usage Examples

Once configured, you can interact with Cube's AI agent directly from your AI assistant:

Ask natural language questions about your data:

- _Show me revenue trends for the last 6 months_
- _What are our top-performing products this quarter?_
- _How does customer acquisition compare year-over-year?_

The server will stream real-time analytics responses with data visualizations and SQL queries.

## How It Works

The MCP server integrates with Cube's [Chat API][ref-chat-api] using API key authentication directly. The Chat API URL should be copied from your agent settings in the Cube admin panel to ensure you're using the correct dynamic endpoint for your deployment.

The server supports two types of user authentication:

- **Internal Users**: Existing Cube users authenticated by their email address. They use their configured permissions and settings from Cube.
- **External Users**: Third-party users with custom identifiers, allowing for dynamic user attributes, groups, and row-level security configuration.

[ref-api-keys]: /product/administration/workspace/api-keys
[ref-chat-api]: /product/apis-integrations/embed-apis/chat-api