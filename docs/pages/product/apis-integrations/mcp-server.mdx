# MCP server

Cube MCP (Model Context Protocol) lets MCP-compatible AI clients connect to Cube over HTTPS using OAuth. You don’t need to run a local MCP server or manage API keys.

<InfoBox>

The MCP server is available on [Premium and Enterprise plans](https://cube.dev/pricing).

</InfoBox>

## What is MCP?

Model Context Protocol (MCP) is an open standard that enables AI assistants to securely connect to external data sources and tools. The Cube MCP Server acts as a bridge between your AI assistant and Cube's analytics platform, allowing you to ask data questions directly from your coding environment.

## Remote MCP server (recommended)

Cube hosts a remote MCP server endpoint for your tenant. MCP clients connect over HTTPS and authenticate via OAuth.

### Overview

- **Endpoint:** `https://<cube-mcp-server-host>/api/mcp`
- **OAuth discovery:** `https://<cube-mcp-server-host>/.well-known/oauth`
- **OAuth flow:** Authorization Code + PKCE, `client_id` = `cube-mcp-client`, scope = `mcp-agent-access`
- **Agent selection:** Uses the **Remote MCP Defaults** (default deployment + agent) set by your admin

### Admin setup

#### Prerequisites

Before enabling Remote MCP, make sure you have:

- **Admin privileges** in your Cube instance
- An active Cube tenant
- Remote MCP URL configured

#### 1) Confirm Remote MCP URL

Remote MCP uses your Cube MCP server host. If the URL isn’t configured, the Remote MCP page will show “Remote MCP configuration is unavailable.”

#### 2) Set Remote MCP Defaults

Go to <Btn>Admin → Remote MCP</Btn> and select:

- **Default Deployment**
- **Default Agent**

These defaults are required for the OAuth token exchange.

#### 3) Enable MCP OAuth integration

Enable MCP in <Btn>Admin → Team & Security → OAuth Integrations</Btn>.

#### 4) Copy the Remote MCP Endpoint

Use the **Remote MCP Endpoint** shown on the same page when configuring clients.

## Connect to Claude

### Claude (Team/Enterprise)

1. Open Settings in Claude (web or desktop).
2. Scroll to **Integrations** and click **Add more**.
3. Use:
   - **Integration name:** Cube MCP
   - **Integration URL:** `https://<cube-mcp-server-host>/api/mcp`
4. Complete the OAuth flow to grant access.
5. Enable tools in any new chats.

> Screenshot placeholder: Claude Integrations settings with Cube MCP URL filled in.

> Screenshot placeholder: OAuth login/consent flow (choose tenant, grant access).

> Screenshot placeholder: Claude chat with Cube MCP enabled and a sample response.

#### Use Cube in Claude chat

1. Start a new chat in Claude.
2. Open the tools menu and enable **Cube MCP** (use the tools search if you have many tools).
3. Ask a data question. Toggle the tool off to disable it for that chat.

### Claude (Desktop app)

```json
{
  "mcpServers": {
    "cube-mcp-server": {
      "command": "npx",
      "args": ["-y", "mcp-remote", "--transport", "http", "https://<cube-mcp-server-host>/api/mcp"]
    }
  }
}
```

### Claude Code

```bash
claude mcp add --transport http cube-mcp-server https://<cube-mcp-server-host>/api/mcp
```

OAuth flow:

1. Run the command above.
2. A browser window opens for authentication.
3. Log into Cube and choose your tenant.
4. Return to Claude Code and start asking questions.

## Connect to Cursor

Add the Remote MCP endpoint under Tools & MCP Settings, then complete the OAuth flow.

```json
{
  "mcpServers": {
    "cube-mcp-server": {
      "command": "npx",
      "args": ["-y", "mcp-remote", "--transport", "http", "https://<cube-mcp-server-host>/api/mcp"]
    }
  }
}
```

## Connect to Codex

Preferred (CLI):

```bash
codex mcp add cube-mcp-server --url https://<cube-mcp-server-host>/api/mcp
```

If this is your first time using MCP in Codex, enable the feature in `~/.codex/config.toml`:

```editorconfig
[features]
rmcp_client = true
```

Manual setup:

```editorconfig
[features]
rmcp_client = true

[mcp_servers."cube-mcp-server"]
url = "https://<cube-mcp-server-host>/api/mcp"
```

Then run `codex mcp login cube-mcp-server` to authenticate.

## Connect to other MCP clients

For any MCP-compatible client:

1. Add a new server with the **Remote MCP Endpoint**.
2. The client will auto-discover OAuth and prompt for authentication.
3. Complete the OAuth flow to grant access to your Cube deployment.

## Available actions

- Chat with your Cube AI agent over MCP
- Query data and request analysis
- Receive responses directly in your MCP client

## Example workflows

- Ask a data question in natural language
- Get SQL generated by the agent
- Request summaries, trends, and insights

## Troubleshooting

- **Remote MCP configuration is unavailable**: Configure the Remote MCP URL.
- **Remote MCP OAuth integration is not configured**: Enable MCP in <Btn>Admin → Team & Security → OAuth Integrations</Btn>.
- **Remote MCP defaults are not configured**: Set defaults in <Btn>Admin → Remote MCP</Btn> under **Remote MCP Defaults**.
- **redirect_uri is not allowed**: For self-hosted or custom clients, update `MCP_ALLOWED_REDIRECT_PATTERNS` on console-server.

## Local MCP server (legacy)

The local MCP server runs on the client and talks directly to the Chat API using an API key. Use this for self-hosted or development setups. Remote MCP is recommended for most users.

Basic config example:

```json
{
  "mcpServers": {
    "cube-mcp-server": {
      "command": "npx",
      "args": ["@cube-dev/mcp-server"],
      "env": {
        "CUBE_CHAT_API_URL": "https://ai.{cloudRegion}.cubecloud.dev/api/v1/public/{accountName}/agents/{agentId}/chat/stream-chat-state",
        "CUBE_API_KEY": "your_api_key_here",
        "INTERNAL_USER_ID": "analyst@yourcompany.com"
      }
    }
  }
}
```

For local server details and updates, see the GitHub repo for `@cube-dev/mcp-server`: [cube-js/cube][ref-mcp-server-github].

[ref-mcp-server-github]: https://github.com/cube-js/cube
