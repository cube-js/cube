---
source: cubesql/src/compile/mod.rs
assertion_line: 6844
expression: "execute_query(\"\n                SELECT\n                    a.attname as fieldname,\n                    a.attnum  as fieldordinal,\n                    a.atttypid as datatype,\n                    a.atttypmod as fieldmod,\n                    a.attnotnull as isnull,\n                    c.relname as tablename,\n                    n.nspname as schema,\n                    CASE\n                        WHEN exists(\n                            select null\n                            from pg_constraint c1\n                            where\n                                c1.conrelid = c.oid and\n                                c1.contype = 'p' and\n                                a.attnum = ANY (c1.conkey)\n                        ) THEN true\n                        ELSE false\n                    END as iskey,\n                    CASE\n                        WHEN exists(\n                            select null\n                            from pg_constraint c1\n                            where\n                                c1.conrelid = c.oid and\n                                c1.contype = 'u' and\n                                a.attnum = ANY (c1.conkey)\n                        ) THEN true\n                        ELSE false\n                    END as isunique,\n                    CAST(pg_get_expr(d.adbin, d.adrelid) AS varchar) as defvalue,\n                    CASE\n                        WHEN t.typtype = 'd' THEN t.typbasetype\n                        ELSE a.atttypid\n                    END as basetype,\n                    CASE\n                        WHEN a.attidentity = 'a' THEN true\n                        ELSE false\n                    END as IsAutoIncrement,\n                    CASE\n                        WHEN\n                            t.typname Like 'bit' OR\n                            t.typname Like 'varbit' and\n                            a.atttypmod > 0\n                        THEN a.atttypmod\n                        WHEN\n                            t.typname Like 'interval' OR\n                            t.typname Like 'timestamp' OR\n                            t.typname Like 'timestamptz' OR\n                            t.typname Like 'time' OR\n                            t.typname Like 'timetz'\n                        THEN -1\n                        WHEN a.atttypmod > 0 THEN a.atttypmod - 4\n                        ELSE a.atttypmod\n                    END as Length,\n                    (information_schema._pg_numeric_precision(\n                        information_schema._pg_truetypid(a .*, t.*),\n                        information_schema._pg_truetypmod(a .*, t.*)\n                    ))::information_schema.cardinal_number AS Precision,\n                    (information_schema._pg_numeric_scale(\n                        information_schema._pg_truetypid(a .*, t.*),\n                        information_schema._pg_truetypmod(a .*, t.*)\n                    ))::information_schema.cardinal_number AS Scale,\n                    (information_schema._pg_datetime_precision(\n                        information_schema._pg_truetypid(a .*, t.*),\n                        information_schema._pg_truetypmod(a .*, t.*)\n                    ))::information_schema.cardinal_number AS DatetimePrecision\n                FROM pg_namespace n\n                INNER JOIN pg_class c ON c.relnamespace = n.oid\n                INNER JOIN pg_attribute a on c.oid = a.attrelid\n                LEFT JOIN pg_attrdef d on\n                    d.adrelid = a.attrelid and\n                    d.adnum =a.attnum\n                LEFT JOIN pg_type t on t.oid = a.atttypid\n                WHERE\n                    a.attisdropped = false AND\n                    (\n                        (c.relkind = 'r') OR\n                        (c.relkind = 's') OR\n                        (c.relkind = 'v') OR\n                        (c.relkind = 'm') OR\n                        (c.relkind = 'f')\n                    ) AND\n                    a.attnum > 0 AND\n                    ((\n                        c.relname LIKE 'KibanaSampleDataEcommerce' AND\n                        n.nspname LIKE 'public'\n                    ))\n                ORDER BY\n                    tablename,\n                    fieldordinal\n                ;\n                \".to_string(),\n            DatabaseProtocol::PostgreSQL).await?"
---
+--------------------+--------------+----------+----------+--------+---------------------------+--------+-------+----------+----------+----------+-----------------+--------+-----------+-------+-------------------+
| fieldname          | fieldordinal | datatype | fieldmod | isnull | tablename                 | schema | iskey | isunique | defvalue | basetype | IsAutoIncrement | Length | Precision | Scale | DatetimePrecision |
+--------------------+--------------+----------+----------+--------+---------------------------+--------+-------+----------+----------+----------+-----------------+--------+-----------+-------+-------------------+
| count              | 1            | 20       | -1       | true   | KibanaSampleDataEcommerce | public | false | false    | NULL     | 20       | false           | -1     | 64        | 0     | NULL              |
| maxPrice           | 2            | 1700     | -1       | true   | KibanaSampleDataEcommerce | public | false | false    | NULL     | 1700     | false           | -1     | NULL      | NULL  | NULL              |
| minPrice           | 3            | 1700     | -1       | true   | KibanaSampleDataEcommerce | public | false | false    | NULL     | 1700     | false           | -1     | NULL      | NULL  | NULL              |
| avgPrice           | 4            | 1700     | -1       | true   | KibanaSampleDataEcommerce | public | false | false    | NULL     | 1700     | false           | -1     | NULL      | NULL  | NULL              |
| order_date         | 5            | 1114     | -1       | false  | KibanaSampleDataEcommerce | public | false | false    | NULL     | 1114     | false           | -1     | NULL      | NULL  | 6                 |
| customer_gender    | 6            | 25       | -1       | false  | KibanaSampleDataEcommerce | public | false | false    | NULL     | 25       | false           | -1     | NULL      | NULL  | NULL              |
| taxful_total_price | 7            | 1700     | -1       | false  | KibanaSampleDataEcommerce | public | false | false    | NULL     | 1700     | false           | -1     | NULL      | NULL  | NULL              |
| has_subscription   | 8            | 16       | -1       | false  | KibanaSampleDataEcommerce | public | false | false    | NULL     | 16       | false           | -1     | NULL      | NULL  | NULL              |
| is_male            | 9            | 16       | -1       | true   | KibanaSampleDataEcommerce | public | false | false    | NULL     | 16       | false           | -1     | NULL      | NULL  | NULL              |
| is_female          | 10           | 16       | -1       | true   | KibanaSampleDataEcommerce | public | false | false    | NULL     | 16       | false           | -1     | NULL      | NULL  | NULL              |
| __user             | 11           | 25       | -1       | false  | KibanaSampleDataEcommerce | public | false | false    | NULL     | 25       | false           | -1     | NULL      | NULL  | NULL              |
+--------------------+--------------+----------+----------+--------+---------------------------+--------+-------+----------+----------+----------+-----------------+--------+-----------+-------+-------------------+
