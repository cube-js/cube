---
source: cubesql/src/compile/mod.rs
expression: "execute_query(\"\n                SELECT\n                    na.nspname as Schema,\n                    cl.relname as Table,\n                    att.attname AS Name,\n                    att.attnum as Position,\n                    CASE\n                        WHEN att.attnotnull = 'f' THEN 'true'\n                        ELSE 'false'\n                    END as Nullable,\n                    CASE\n                        WHEN\n                            ty.typname Like 'bit' OR\n                            ty.typname Like 'varbit' and\n                            att.atttypmod > 0\n                        THEN att.atttypmod\n                        WHEN ty.typname Like 'interval' THEN -1\n                        WHEN att.atttypmod > 0 THEN att.atttypmod - 4\n                        ELSE att.atttypmod\n                    END as Length,\n                    (information_schema._pg_numeric_precision(information_schema._pg_truetypid(att.*, ty.*), information_schema._pg_truetypmod(att.*, ty.*)))::information_schema.cardinal_number AS Precision,\n                    (information_schema._pg_numeric_scale(information_schema._pg_truetypid(att.*, ty.*), information_schema._pg_truetypmod(att.*, ty.*)))::information_schema.cardinal_number AS Scale,\n                    (information_schema._pg_datetime_precision(information_schema._pg_truetypid(att.*, ty.*), information_schema._pg_truetypmod(att.*, ty.*)))::information_schema.cardinal_number AS DatetimeLength,\n                    CASE\n                        WHEN att.attnotnull = 'f' THEN 'false'\n                        ELSE 'true'\n                    END as IsUnique,\n                    att.atthasdef as HasDefaultValue,\n                    att.attisdropped as IsDropped,\n                    att.attinhcount as ancestorCount,\n                    att.attndims as Dimension,\n                    CASE\n                        WHEN attndims > 0 THEN true\n                        ELSE false\n                    END AS isarray,\n                    CASE\n                        WHEN ty.typname = 'bpchar' THEN 'char'\n                        WHEN ty.typname = '_bpchar' THEN '_char'\n                        ELSE ty.typname\n                    END as TypeName,\n                    tn.nspname as TypeSchema,\n                    et.typname as elementaltypename,\n                    description as Comment,\n                    cs.relname AS sername,\n                    ns.nspname AS serschema,\n                    att.attidentity as IdentityMode,\n                    CAST(pg_get_expr(def.adbin, def.adrelid) AS varchar) as DefaultValue,\n                    (SELECT count(1) FROM pg_type t2 WHERE t2.typname=ty.typname) > 1 AS isdup\n                FROM pg_attribute att\n                JOIN pg_type ty ON ty.oid=atttypid\n                JOIN pg_namespace tn ON tn.oid=ty.typnamespace\n                JOIN pg_class cl ON\n                    cl.oid=attrelid AND\n                    (\n                        (cl.relkind = 'r') OR\n                        (cl.relkind = 's') OR\n                        (cl.relkind = 'v') OR\n                        (cl.relkind = 'm') OR\n                        (cl.relkind = 'f')\n                    )\n                JOIN pg_namespace na ON na.oid=cl.relnamespace\n                LEFT OUTER JOIN pg_type et ON et.oid=ty.typelem\n                LEFT OUTER JOIN pg_attrdef def ON\n                    adrelid=attrelid AND\n                    adnum=attnum\n                LEFT OUTER JOIN pg_description des ON\n                    des.objoid=attrelid AND\n                    des.objsubid=attnum\n                LEFT OUTER JOIN (\n                    pg_depend\n                    JOIN pg_class cs ON\n                        objid=cs.oid AND\n                        cs.relkind='S' AND\n                        classid='pg_class'::regclass::oid\n                ) ON\n                    refobjid=attrelid AND\n                    refobjsubid=attnum\n                LEFT OUTER JOIN pg_namespace ns ON ns.oid=cs.relnamespace\n                WHERE\n                    attnum > 0 AND\n                    attisdropped IS FALSE AND\n                    cl.relname like E'KibanaSampleDataEcommerce' AND\n                    na.nspname like E'public' AND\n                    att.attname like '%'\n                ORDER BY attnum\n                ;\n                \".to_string(),\n            DatabaseProtocol::PostgreSQL).await?"
---
+--------+---------------------------+--------------------+----------+----------+--------+-----------+-------+----------------+----------+-----------------+-----------+---------------+-----------+---------+-----------+------------+-------------------+---------+---------+-----------+--------------+--------------+-------+
| Schema | Table                     | Name               | Position | Nullable | Length | Precision | Scale | DatetimeLength | IsUnique | HasDefaultValue | IsDropped | ancestorCount | Dimension | isarray | TypeName  | TypeSchema | elementaltypename | Comment | sername | serschema | IdentityMode | DefaultValue | isdup |
+--------+---------------------------+--------------------+----------+----------+--------+-----------+-------+----------------+----------+-----------------+-----------+---------------+-----------+---------+-----------+------------+-------------------+---------+---------+-----------+--------------+--------------+-------+
| public | KibanaSampleDataEcommerce | count              | 1        | false    | -1     | 64        | 0     | NULL           | true     | false           | false     | 0             | 0         | false   | int8      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | maxPrice           | 2        | false    | -1     | NULL      | NULL  | NULL           | true     | false           | false     | 0             | 0         | false   | numeric   | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | minPrice           | 3        | false    | -1     | NULL      | NULL  | NULL           | true     | false           | false     | 0             | 0         | false   | numeric   | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | avgPrice           | 4        | false    | -1     | NULL      | NULL  | NULL           | true     | false           | false     | 0             | 0         | false   | numeric   | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | countDistinct      | 5        | false    | -1     | 64        | 0     | NULL           | true     | false           | false     | 0             | 0         | false   | int8      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | order_date         | 6        | true     | -1     | NULL      | NULL  | 6              | false    | false           | false     | 0             | 0         | false   | timestamp | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | customer_gender    | 7        | true     | -1     | NULL      | NULL  | NULL           | false    | false           | false     | 0             | 0         | false   | text      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | notes              | 8        | true     | -1     | NULL      | NULL  | NULL           | false    | false           | false     | 0             | 0         | false   | text      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | taxful_total_price | 9        | true     | -1     | NULL      | NULL  | NULL           | false    | false           | false     | 0             | 0         | false   | numeric   | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | has_subscription   | 10       | true     | -1     | NULL      | NULL  | NULL           | false    | false           | false     | 0             | 0         | false   | bool      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | is_male            | 11       | false    | -1     | NULL      | NULL  | NULL           | true     | false           | false     | 0             | 0         | false   | bool      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | is_female          | 12       | false    | -1     | NULL      | NULL  | NULL           | true     | false           | false     | 0             | 0         | false   | bool      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | __user             | 13       | true     | -1     | NULL      | NULL  | NULL           | false    | false           | false     | 0             | 0         | false   | text      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
| public | KibanaSampleDataEcommerce | __cubeJoinField    | 14       | true     | -1     | NULL      | NULL  | NULL           | false    | false           | false     | 0             | 0         | false   | text      | pg_catalog | NULL              | NULL    | NULL    | NULL      |              | NULL         | false |
+--------+---------------------------+--------------------+----------+----------+--------+-----------+-------+----------------+----------+-----------------+-----------+---------------+-----------+---------+-----------+------------+-------------------+---------+---------+-----------+--------------+--------------+-------+
