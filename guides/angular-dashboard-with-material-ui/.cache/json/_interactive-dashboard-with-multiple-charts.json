{"data":{"markdownRemark":{"html":"<p>In the previous part, we've created an analytical backend and a basic dashboard with the first chart. Now we're going to expand the dashboard so it provides the at-a-glance view of key performance indicators of our e-commerce company.</p>\n<h2 id=\"custom-date-range\" style=\"position:relative;\"><a href=\"#custom-date-range\" aria-label=\"custom date range permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Custom Date Range</h2>\n<p>As the first step, we'll let users change the date range of the existing chart.</p>\n<p>We'll use a separate <code class=\"language-text\">&lt;BarChartHeader /&gt;</code> component to control the date range. Let's create the <code class=\"language-text\">src/components/BarChartHeader.js</code> file with the following contents:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> makeStyles <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/styles'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CardHeader<span class=\"token punctuation\">,</span> Button <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ArrowDropDownIcon <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/icons/ArrowDropDown'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Menu <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/core/Menu'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> MenuItem <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/core/MenuItem'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> useStyles <span class=\"token operator\">=</span> <span class=\"token function\">makeStyles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  headerButton<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    letterSpacing<span class=\"token operator\">:</span> <span class=\"token string\">'0.4px'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">BarChartHeader</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> setDateRange<span class=\"token punctuation\">,</span> dateRange<span class=\"token punctuation\">,</span> dates <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> defaultDates <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'This week'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'This month'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Last 7 days'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Last month'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> classes <span class=\"token operator\">=</span> <span class=\"token function\">useStyles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>anchorEl<span class=\"token punctuation\">,</span> setAnchorEl<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setAnchorEl</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleClose</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">date</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setDateRange</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setAnchorEl</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CardHeader</span></span>\n      <span class=\"token attr-name\">action</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span>\n            <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>headerButton<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>small<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">aria-controls</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>simple-menu<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">aria-haspopup</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleClick<span class=\"token punctuation\">}</span></span>\n          <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token punctuation\">{</span>dateRange<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ArrowDropDownIcon</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Menu</span></span>\n            <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>simple-menu<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">anchorEl</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>anchorEl<span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">keepMounted</span>\n            <span class=\"token attr-name\">open</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">Boolean</span><span class=\"token punctuation\">(</span>anchorEl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">onClose</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handleClose</span><span class=\"token punctuation\">(</span>dateRange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span>\n          <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token punctuation\">{</span>dates <span class=\"token operator\">?</span>\n              dates<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">date</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MenuItem</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>date<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handleClose</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>date<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MenuItem</span></span><span class=\"token punctuation\">></span></span>\n              <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n             <span class=\"token operator\">:</span> defaultDates<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">date</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MenuItem</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>date<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handleClose</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>date<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MenuItem</span></span><span class=\"token punctuation\">></span></span>\n              <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Menu</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">}</span></span>\n      <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Latest Sales<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nBarChartHeader<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  className<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> BarChartHeader<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now let's add this <code class=\"language-text\">&lt;BarChartHeader /&gt;</code> component to our existing chart. Make the following changes in the <code class=\"language-text\">src/components/BarChart.js</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">// ...\nimport ChartRenderer from './ChartRenderer'\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> import BarChartHeader from \"./BarChartHeader\";\n</span>// ...\nconst BarChart = (props) => {\n<span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>  const { className, query, ...rest } = props;\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  const { className, query, dates, ...rest } = props;\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> const classes = useStyles();\n</span>\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  const [dateRange, setDateRange] = React.useState(dates ? dates[0] : 'This week');\n<span class=\"token prefix inserted\">+</span>  let queryWithDate = {...query,\n<span class=\"token prefix inserted\">+</span>    timeDimensions: [\n<span class=\"token prefix inserted\">+</span>      {\n<span class=\"token prefix inserted\">+</span>        dimension: query.timeDimensions[0].dimension,\n<span class=\"token prefix inserted\">+</span>        granularity: query.timeDimensions[0].granularity,\n<span class=\"token prefix inserted\">+</span>        dateRange: `${dateRange}`\n<span class=\"token prefix inserted\">+</span>      }\n<span class=\"token prefix inserted\">+</span>    ],\n<span class=\"token prefix inserted\">+</span>  };\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> return (\n<span class=\"token prefix unchanged\"> </span>   &lt;Card {...rest} className={clsx(classes.root, className)}>\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>      &lt;BarChartHeader dates={dates} dateRange={dateRange} setDateRange={setDateRange} />\n<span class=\"token prefix inserted\">+</span>      &lt;Divider />\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>     &lt;CardContent>\n<span class=\"token prefix unchanged\"> </span>       &lt;div className={classes.chartContainer}>\n<span class=\"token prefix unchanged\"> </span>         &lt;ChartRenderer vizState={{ query: queryWithDate, chartType: 'bar' }}/>\n<span class=\"token prefix unchanged\"> </span>       &lt;/div>\n<span class=\"token prefix unchanged\"> </span>     &lt;/CardContent>\n<span class=\"token prefix unchanged\"> </span>   &lt;/Card>\n<span class=\"token prefix unchanged\"> </span> )\n</span>};\n// ...</code></pre></div>\n<p>Well done! ðŸŽ‰ Here's what our dashboard application looks like:</p>\n<p><img src=\"/images/image-48.png\"></p>\n<h2 id=\"kpi-chart\" style=\"position:relative;\"><a href=\"#kpi-chart\" aria-label=\"kpi chart permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>KPI Chart</h2>\n<p>The KPI chart can be used to display business indicators that provide information about the current performance of our e-commerce company. The chart will consist of a grid of tiles, where each tile will display a single numeric KPI value for a certain category.</p>\n<p>First, let's use the <code class=\"language-text\">react-countup</code> package to add the count-up animation to the values on the KPI chart. Run the following command in the <code class=\"language-text\">dashboard-app</code> folder:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">npm install <span class=\"token operator\">--</span>save react<span class=\"token operator\">-</span>countup</code></pre></div>\n<p>New we're ready to add new <code class=\"language-text\">&lt;KPIChart/&gt;</code> component. Add the <code class=\"language-text\">src/components/KPIChart.js</code> component with the following contents:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> clsx <span class=\"token keyword\">from</span> <span class=\"token string\">'clsx'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> makeStyles <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/styles'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Card<span class=\"token punctuation\">,</span> CardContent<span class=\"token punctuation\">,</span> Grid<span class=\"token punctuation\">,</span> Typography<span class=\"token punctuation\">,</span> LinearProgress <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useCubeQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@cubejs-client/react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> CountUp <span class=\"token keyword\">from</span> <span class=\"token string\">'react-countup'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> CircularProgress <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/core/CircularProgress'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> useStyles <span class=\"token operator\">=</span> <span class=\"token function\">makeStyles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">theme</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  root<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    height<span class=\"token operator\">:</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  content<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    alignItems<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span>\n    display<span class=\"token operator\">:</span> <span class=\"token string\">'flex'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  title<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    fontWeight<span class=\"token operator\">:</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  progress<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    marginTop<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span><span class=\"token function\">spacing</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token string\">'8px'</span><span class=\"token punctuation\">,</span>\n    borderRadius<span class=\"token operator\">:</span> <span class=\"token string\">'10px'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  difference<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    marginTop<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span><span class=\"token function\">spacing</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    display<span class=\"token operator\">:</span> <span class=\"token string\">'flex'</span><span class=\"token punctuation\">,</span>\n    alignItems<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  differenceIcon<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>palette<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">.</span>dark<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  differenceValue<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    marginRight<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span><span class=\"token function\">spacing</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  green<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>palette<span class=\"token punctuation\">.</span>success<span class=\"token punctuation\">.</span>dark<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  red<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>palette<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">.</span>dark<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">KPIChart</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> classes <span class=\"token operator\">=</span> <span class=\"token function\">useStyles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> className<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> progress<span class=\"token punctuation\">,</span> query<span class=\"token punctuation\">,</span> difference<span class=\"token punctuation\">,</span> duration<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> resultSet<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">,</span> isLoading <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useCubeQuery</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> differenceQuery <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>query<span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"timeDimensions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"dimension\"</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>difference <span class=\"token operator\">||</span> query<span class=\"token punctuation\">.</span>measures<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.createdAt</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"granularity\"</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"dateRange\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"This year\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> differenceValue <span class=\"token operator\">=</span> <span class=\"token function\">useCubeQuery</span><span class=\"token punctuation\">(</span>differenceQuery<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isLoading <span class=\"token operator\">||</span> differenceValue<span class=\"token punctuation\">.</span>isLoading<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> display<span class=\"token operator\">:</span> <span class=\"token string\">'flex'</span><span class=\"token punctuation\">,</span> alignItems<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span> justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CircularProgress</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>secondary<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token operator\">||</span> differenceValue<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>pre</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span>error <span class=\"token operator\">||</span> differenceValue<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>pre</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>resultSet <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>differenceValue<span class=\"token punctuation\">.</span>resultSet<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resultSet <span class=\"token operator\">&amp;&amp;</span> differenceValue<span class=\"token punctuation\">.</span>resultSet<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> postfix <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> prefix <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> measureKey <span class=\"token operator\">=</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">seriesNames</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> annotations <span class=\"token operator\">=</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">tableColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tableColumn</span> <span class=\"token operator\">=></span> tableColumn<span class=\"token punctuation\">.</span>key <span class=\"token operator\">===</span> measureKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> format <span class=\"token operator\">=</span> annotations<span class=\"token punctuation\">.</span>format <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>annotations<span class=\"token punctuation\">.</span>meta <span class=\"token operator\">&amp;&amp;</span> annotations<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">.</span>format<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>format <span class=\"token operator\">===</span> <span class=\"token string\">'percent'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      postfix <span class=\"token operator\">=</span> <span class=\"token string\">'%'</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>format <span class=\"token operator\">===</span> <span class=\"token string\">'currency'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      prefix <span class=\"token operator\">=</span> <span class=\"token string\">'$'</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> fullValue <span class=\"token operator\">=</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">seriesNames</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">s</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">totalRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>s<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>difference<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      value <span class=\"token operator\">=</span> differenceValue<span class=\"token punctuation\">.</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">totalRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>differenceQuery<span class=\"token punctuation\">.</span>measures<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> fullValue <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Card</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">rest</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">clsx</span><span class=\"token punctuation\">(</span>classes<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">,</span> className<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CardContent</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Grid</span></span> <span class=\"token attr-name\">container</span> <span class=\"token attr-name\">justify</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>space-between<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Grid</span></span> <span class=\"token attr-name\">item</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Typography</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>textSecondary<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">gutterBottom</span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>body2<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Typography</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Typography</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>h3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token punctuation\">{</span>prefix<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CountUp</span></span>\n                  <span class=\"token attr-name\">end</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>fullValue<span class=\"token punctuation\">}</span></span>\n                  <span class=\"token attr-name\">duration</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>duration<span class=\"token punctuation\">}</span></span>\n                  <span class=\"token attr-name\">separator</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>,<span class=\"token punctuation\">\"</span></span>\n                  <span class=\"token attr-name\">decimals</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span></span>\n                <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n                </span><span class=\"token punctuation\">{</span>postfix<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Typography</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Grid</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Grid</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span>progress <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LinearProgress</span></span>\n              <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>progress<span class=\"token punctuation\">}</span></span>\n              <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>fullValue<span class=\"token punctuation\">}</span></span>\n              <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>determinate<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token punctuation\">/></span></span>\n          <span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span>difference <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>difference<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Typography</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>differenceValue<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>body2<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token punctuation\">{</span>value <span class=\"token operator\">></span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>\n                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>green<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">%</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>\n                  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>red<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">%</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Typography</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Typography</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>caption<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>caption<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                Since this year\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Typography</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">CardContent</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Card</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nKPIChart<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  className<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n  title<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> KPIChart<span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Let's learn how to create custom measures in the data schema and display their values.</strong> In the e-commerce business, it's crucial to know the share of completed orders. To enable our users to monitor this metric, we'll want to display it on the KPI chart. So, we will modify the data schema by <a href=\"https://cube.dev/docs/measures/\">adding a custom measure</a> (<code class=\"language-text\">percentOfCompletedOrders</code>) which will calculate the share based on another measure (<code class=\"language-text\">completedCount</code>).</p>\n<p>Let's customize the \"Orders\" schema. Open the <code class=\"language-text\">schema/Orders.js</code> file in the root folder of the Cube.js project and make the following changes: </p>\n<ul>\n<li>add the <code class=\"language-text\">completedCount</code> measure</li>\n<li>add the <code class=\"language-text\">percentOfCompletedOrders</code> measure</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">cube(`Orders`, {\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> sql: `SELECT * FROM public.orders`,\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> //.. \n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> measures: {\n<span class=\"token prefix unchanged\"> </span>   count: {\n<span class=\"token prefix unchanged\"> </span>     type: `count`,\n<span class=\"token prefix unchanged\"> </span>     drillMembers: [id, createdAt]\n<span class=\"token prefix unchanged\"> </span>   },\n<span class=\"token prefix unchanged\"> </span>   number: {\n<span class=\"token prefix unchanged\"> </span>     sql: `number`,\n<span class=\"token prefix unchanged\"> </span>     type: `sum`\n<span class=\"token prefix unchanged\"> </span>   },\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    completedCount: {\n<span class=\"token prefix inserted\">+</span>      sql: `id`,\n<span class=\"token prefix inserted\">+</span>      type: `count`,\n<span class=\"token prefix inserted\">+</span>      filters: [\n<span class=\"token prefix inserted\">+</span>        { sql: `${CUBE}.status = 'completed'` }\n<span class=\"token prefix inserted\">+</span>      ]\n<span class=\"token prefix inserted\">+</span>    },\n<span class=\"token prefix inserted\">+</span>    percentOfCompletedOrders: {\n<span class=\"token prefix inserted\">+</span>      sql: `${completedCount}*100.0/${count}`,\n<span class=\"token prefix inserted\">+</span>      type: `number`,\n<span class=\"token prefix inserted\">+</span>      format: `percent`\n<span class=\"token prefix inserted\">+</span>    }\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> },\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> // ...</span></code></pre></div>\n<p>Now we're ready to add the KPI chart displaying a number of KPIs to the dashboard. Make the following changes to the <code class=\"language-text\">src/pages/DashboardPage.js</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">// ...\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> import KPIChart from '../components/KPIChart';\n</span>import BarChart from '../components/BarChart.js'\n// ...\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> const cards = [\n<span class=\"token prefix inserted\">+</span>  {\n<span class=\"token prefix inserted\">+</span>    title: 'ORDERS',\n<span class=\"token prefix inserted\">+</span>    query: { measures: ['Orders.count'] },\n<span class=\"token prefix inserted\">+</span>    difference: 'Orders',\n<span class=\"token prefix inserted\">+</span>    duration: 1.25,\n<span class=\"token prefix inserted\">+</span>  },\n<span class=\"token prefix inserted\">+</span>  {\n<span class=\"token prefix inserted\">+</span>    title: 'TOTAL USERS',\n<span class=\"token prefix inserted\">+</span>    query: { measures: ['Users.count'] },\n<span class=\"token prefix inserted\">+</span>    difference: 'Users',\n<span class=\"token prefix inserted\">+</span>    duration: 1.5,\n<span class=\"token prefix inserted\">+</span>  },\n<span class=\"token prefix inserted\">+</span>  {\n<span class=\"token prefix inserted\">+</span>    title: 'COMPLETED ORDERS',\n<span class=\"token prefix inserted\">+</span>    query: { measures: ['Orders.percentOfCompletedOrders'] },\n<span class=\"token prefix inserted\">+</span>    progress: true,\n<span class=\"token prefix inserted\">+</span>    duration: 1.75,\n<span class=\"token prefix inserted\">+</span>  },\n<span class=\"token prefix inserted\">+</span>  {\n<span class=\"token prefix inserted\">+</span>    title: 'TOTAL PROFIT',\n<span class=\"token prefix inserted\">+</span>    query: { measures: ['LineItems.price'] },\n<span class=\"token prefix inserted\">+</span>    duration: 2.25,\n<span class=\"token prefix inserted\">+</span>  },\n<span class=\"token prefix inserted\">+</span> ];\n</span>\nconst Dashboard = () => {\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> const classes = useStyles();\n<span class=\"token prefix unchanged\"> </span> return (\n<span class=\"token prefix unchanged\"> </span>   &lt;div className={classes.root}>\n<span class=\"token prefix unchanged\"> </span>     &lt;Grid\n<span class=\"token prefix unchanged\"> </span>       container\n<span class=\"token prefix unchanged\"> </span>       spacing={4}\n<span class=\"token prefix unchanged\"> </span>     >\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>        {cards.map((item, index) => {\n<span class=\"token prefix inserted\">+</span>         return (\n<span class=\"token prefix inserted\">+</span>           &lt;Grid\n<span class=\"token prefix inserted\">+</span>             key={item.title + index}\n<span class=\"token prefix inserted\">+</span>             item\n<span class=\"token prefix inserted\">+</span>             lg={3}\n<span class=\"token prefix inserted\">+</span>             sm={6}\n<span class=\"token prefix inserted\">+</span>             xl={3}\n<span class=\"token prefix inserted\">+</span>             xs={12}\n<span class=\"token prefix inserted\">+</span>           >\n<span class=\"token prefix inserted\">+</span>             &lt;KPIChart {...item}/>\n<span class=\"token prefix inserted\">+</span>           &lt;/Grid>\n<span class=\"token prefix inserted\">+</span>         )\n<span class=\"token prefix inserted\">+</span>       })}\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>       &lt;Grid\n<span class=\"token prefix unchanged\"> </span>         item\n<span class=\"token prefix unchanged\"> </span>         lg={8}\n<span class=\"token prefix unchanged\"> </span>         md={12}\n<span class=\"token prefix unchanged\"> </span>         xl={9}\n<span class=\"token prefix unchanged\"> </span>         xs={12}\n<span class=\"token prefix unchanged\"> </span>       >\n<span class=\"token prefix unchanged\"> </span>         &lt;BarChart/>\n<span class=\"token prefix unchanged\"> </span>       &lt;/Grid>\n<span class=\"token prefix unchanged\"> </span>     &lt;/Grid>\n<span class=\"token prefix unchanged\"> </span>   &lt;/div>\n<span class=\"token prefix unchanged\"> </span> );\n</span>};</code></pre></div>\n<p>Great! ðŸŽ‰ Now our dashboard has a row of nice and informative KPI metrics:</p>\n<p><img src=\"/images/image-18.png\"></p>\n<h2 id=\"doughnut-chart\" style=\"position:relative;\"><a href=\"#doughnut-chart\" aria-label=\"doughnut chart permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Doughnut Chart</h2>\n<p>Now, using the KPI chart, our users are able to monitor the share of completed orders. However, there are two more kinds of orders: \"processed\" orders (ones that were acknowledged but not yet shipped) and \"shipped\" orders (essentially, ones that were taken for delivery but not yet completed).</p>\n<p>To enable our users to monitor all these kinds of orders, we'll want to add one final chart to our dashboard. It's best to use the Doughnut chart for that, because it's quite useful to visualize the distribution of a certain metric between several states (e.g., all kinds of orders).</p>\n<p>First, just like in the previous part, we're going to put the chart options to a separate file. Let's create the <code class=\"language-text\">src/helpers/DoughnutOptions.js</code> file with the following contents:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> palette <span class=\"token keyword\">from</span> <span class=\"token string\">\"../theme/palette\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> DoughnutOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  legend<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    display<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  responsive<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  maintainAspectRatio<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  cutoutPercentage<span class=\"token operator\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\n  layout<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> padding<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  tooltips<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    enabled<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    mode<span class=\"token operator\">:</span> <span class=\"token string\">\"index\"</span><span class=\"token punctuation\">,</span>\n    intersect<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    borderWidth<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    borderColor<span class=\"token operator\">:</span> palette<span class=\"token punctuation\">.</span>divider<span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token operator\">:</span> palette<span class=\"token punctuation\">.</span>white<span class=\"token punctuation\">,</span>\n    titleFontColor<span class=\"token operator\">:</span> palette<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>primary<span class=\"token punctuation\">,</span>\n    bodyFontColor<span class=\"token operator\">:</span> palette<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>secondary<span class=\"token punctuation\">,</span>\n    footerFontColor<span class=\"token operator\">:</span> palette<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>secondary\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Then, let's create the <code class=\"language-text\">src/components/DoughnutChart.js</code> for the new chart with the following contents:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Doughnut <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-chartjs-2'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> clsx <span class=\"token keyword\">from</span> <span class=\"token string\">'clsx'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> makeStyles<span class=\"token punctuation\">,</span> useTheme <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/styles'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Card<span class=\"token punctuation\">,</span> CardHeader<span class=\"token punctuation\">,</span> CardContent<span class=\"token punctuation\">,</span> Divider<span class=\"token punctuation\">,</span> Typography <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useCubeQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@cubejs-client/react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> CircularProgress <span class=\"token keyword\">from</span> <span class=\"token string\">'@material-ui/core/CircularProgress'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> DoughnutOptions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../helpers/DoughnutOptions.js'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> useStyles <span class=\"token operator\">=</span> <span class=\"token function\">makeStyles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">theme</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  root<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    height<span class=\"token operator\">:</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  chartContainer<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    marginTop<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span><span class=\"token function\">spacing</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    position<span class=\"token operator\">:</span> <span class=\"token string\">'relative'</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token string\">'300px'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  stats<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    marginTop<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span><span class=\"token function\">spacing</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    display<span class=\"token operator\">:</span> <span class=\"token string\">'flex'</span><span class=\"token punctuation\">,</span>\n    justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  status<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    textAlign<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span>\n    padding<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span><span class=\"token function\">spacing</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  title<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>palette<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>secondary<span class=\"token punctuation\">,</span>\n    paddingBottom<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span><span class=\"token function\">spacing</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  statusIcon<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> theme<span class=\"token punctuation\">.</span>palette<span class=\"token punctuation\">.</span>icon<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">DoughnutChart</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> className<span class=\"token punctuation\">,</span> query<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> classes <span class=\"token operator\">=</span> <span class=\"token function\">useStyles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> theme <span class=\"token operator\">=</span> <span class=\"token function\">useTheme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> resultSet<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">,</span> isLoading <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useCubeQuery</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isLoading<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> display<span class=\"token operator\">:</span> <span class=\"token string\">'flex'</span><span class=\"token punctuation\">,</span> alignItems<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span><span class=\"token punctuation\">,</span> justifyContent<span class=\"token operator\">:</span> <span class=\"token string\">'center'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CircularProgress</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>secondary<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>pre</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>error<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>pre</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>resultSet<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resultSet<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">COLORS_SERIES</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n      theme<span class=\"token punctuation\">.</span>palette<span class=\"token punctuation\">.</span>secondary<span class=\"token punctuation\">.</span>light<span class=\"token punctuation\">,</span>\n      theme<span class=\"token punctuation\">.</span>palette<span class=\"token punctuation\">.</span>secondary<span class=\"token punctuation\">.</span>lighten<span class=\"token punctuation\">,</span>\n      theme<span class=\"token punctuation\">.</span>palette<span class=\"token punctuation\">.</span>secondary<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      labels<span class=\"token operator\">:</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">categories</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>category<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      datasets<span class=\"token operator\">:</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">series</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">s</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        label<span class=\"token operator\">:</span> s<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n        data<span class=\"token operator\">:</span> s<span class=\"token punctuation\">.</span>series<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> r<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        backgroundColor<span class=\"token operator\">:</span> <span class=\"token constant\">COLORS_SERIES</span><span class=\"token punctuation\">,</span>\n        hoverBackgroundColor<span class=\"token operator\">:</span> <span class=\"token constant\">COLORS_SERIES</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">reducer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">accumulator<span class=\"token punctuation\">,</span> currentValue</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> accumulator <span class=\"token operator\">+</span> currentValue<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Card</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">rest</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">clsx</span><span class=\"token punctuation\">(</span>classes<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">,</span> className<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CardHeader</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Orders status<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Divider</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CardContent</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>chartContainer<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Doughnut</span></span> <span class=\"token attr-name\">data</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">options</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>DoughnutOptions<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>stats<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token punctuation\">{</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">series</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>series<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>status<span class=\"token punctuation\">.</span>category<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Typography</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>body1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>classes<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                  </span><span class=\"token punctuation\">{</span>status<span class=\"token punctuation\">.</span>category<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Typography</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Typography</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>h2<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>value<span class=\"token operator\">/</span>resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">series</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>series<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=></span> el<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>reducer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">%</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Typography</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">CardContent</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Card</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nDoughnutChart<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  className<span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> DoughnutChart<span class=\"token punctuation\">;</span></code></pre></div>\n<p>The last step is to add the new chart to the dashboard. Let's modify the <code class=\"language-text\">src/pages/DashboardPage.js</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">// ...\nimport DataCard from '../components/DataCard';\nimport BarChart from '../components/BarChart.js'\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> import DoughnutChart from '../components/DoughnutChart.js'\n</span>\n// ...\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> const doughnutChartQuery = {\n<span class=\"token prefix inserted\">+</span>  measures: ['Orders.count'],\n<span class=\"token prefix inserted\">+</span>  timeDimensions: [\n<span class=\"token prefix inserted\">+</span>    {\n<span class=\"token prefix inserted\">+</span>      dimension: 'Orders.createdAt',\n<span class=\"token prefix inserted\">+</span>    },\n<span class=\"token prefix inserted\">+</span>  ],\n<span class=\"token prefix inserted\">+</span>  filters: [],\n<span class=\"token prefix inserted\">+</span>  dimensions: ['Orders.status'],\n<span class=\"token prefix inserted\">+</span> };\n</span>//...\n\nreturn (\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>   &lt;div className={classes.root}>\n<span class=\"token prefix unchanged\"> </span>     &lt;Grid\n<span class=\"token prefix unchanged\"> </span>       container\n<span class=\"token prefix unchanged\"> </span>       spacing={4}\n<span class=\"token prefix unchanged\"> </span>     >\n<span class=\"token prefix unchanged\"> </span>       // ..\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>        &lt;Grid\n<span class=\"token prefix inserted\">+</span>          item\n<span class=\"token prefix inserted\">+</span>          lg={4}\n<span class=\"token prefix inserted\">+</span>          md={6}\n<span class=\"token prefix inserted\">+</span>          xl={3}\n<span class=\"token prefix inserted\">+</span>          xs={12}\n<span class=\"token prefix inserted\">+</span>        >\n<span class=\"token prefix inserted\">+</span>          &lt;DoughnutChart query={doughnutChartQuery}/>\n<span class=\"token prefix inserted\">+</span>        &lt;/Grid>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>     &lt;/Grid>\n<span class=\"token prefix unchanged\"> </span>   &lt;/div>\n<span class=\"token prefix unchanged\"> </span> );</span></code></pre></div>\n<p>Awesome! ðŸŽ‰ Now the first page of our dashboard is complete:</p>\n<p><img src=\"/images/image-53.png\"></p>\n<p>If you like the layout of our dashboard, check out the <a href=\"https://github.com/devias-io/react-material-dashboard\">Devias Kit Admin Dashboard</a>, an open source React Dashboard made with Material UI's components. </p>","timeToRead":9,"excerpt":"In the previous part, we've created an analytical backend and a basic dashboard with the first chart. Now we're going to expand theâ€¦","frontmatter":{"title":"Interactive Dashboard with Multiple Charts"},"fields":{"slug":"/interactive-dashboard-with-multiple-charts"}}},"pageContext":{"config":{"siteTitle":"Material UI Dashboard with Angular","siteTitleShort":"Material UI Dashboard with Angular","siteTitleAlt":"Material UI Dashboard with Angular","siteLogo":"/logos/icon.png","previewImage":"/logos/preview.png","siteUrl":"https://angular-dashboard.cube.dev","siteDescription":"How to build Angular Material Dashboard with Cube.js.","googleAnalyticsID":"UA-70480064-3","themeColor":"#c62828","backgroundColor":"#e0e0e0","pathPrefix":"","githubUrl":"https://github.com/cube-js/cube.js/tree/master/examples/angular-dashboard-with-material-ui"},"slug":"/interactive-dashboard-with-multiple-charts","nexttitle":"Multi-Page Dashboard with Data Table","nextslug":"/multi-page-dashboard-with-data-table","prevtitle":"Frontend with Material UI","prevslug":"/frontend-with-material-ui","tableOfContents":[{"node":{"fields":{"slug":"/overview"},"frontmatter":{"title":"Overview","order":1}}},{"node":{"fields":{"slug":"/analytics-backend-with-cube-js"},"frontmatter":{"title":"Analytics Backend with Cube.js","order":2}}},{"node":{"fields":{"slug":"/frontend-with-material-ui"},"frontmatter":{"title":"Frontend with Material UI","order":3}}},{"node":{"fields":{"slug":"/interactive-dashboard-with-multiple-charts"},"frontmatter":{"title":"Interactive Dashboard with Multiple Charts","order":4}}},{"node":{"fields":{"slug":"/multi-page-dashboard-with-data-table"},"frontmatter":{"title":"Multi-Page Dashboard with Data Table","order":5}}}]}}